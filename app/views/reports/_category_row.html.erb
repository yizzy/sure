<%
  percentage = total.zero? ? 0 : (item[:total].to_f / total * 100).round(1)
  is_sub = level == :subcategory
%>

<div class="grid grid-cols-4 sm:grid-cols-12 items-center text-secondary text-sm p-3 <%= is_sub ? "pl-6" : "" %>">
  <div class="col-span-2 sm:col-span-6 flex items-center gap-2 px-2">
    <% if is_sub %>
      <div class="text-subdued">
        <%= icon "corner-down-right" %>
      </div>
    <% end %>
    <% if item[:category_icon] %>
      <div class="h-7 w-7 flex-shrink-0 rounded-full flex justify-center items-center"
        style="
          background-color: color-mix(in oklab, <%= item[:category_color] %> 10%, transparent);
          border-color: color-mix(in oklab, <%= item[:category_color] %> 10%, transparent);
          color: <%= item[:category_color] %>;
        ">
        <%= icon(item[:category_icon], color: "current", size: "sm") %>
      </div>
    <% else %>
      <%= render DS::FilledIcon.new(
        variant: :text,
        hex_color: item[:category_color],
        text: item[:category_name],
        size: "md",
        rounded: true
      ) %>
    <% end %>
    <span class="font-medium text-primary">
      <%= item[:category_name] %>
    </span>
    <span class="text-xs text-tertiary whitespace-nowrap">
      (<%= t("reports.transactions_breakdown.table.entries", count: item[:count]) %>)
    </span>
  </div>

  <div class="col-span-1 sm:col-span-3 justify-self-end">
    <span class="text-sm <%= color_class %>">
      <%= Money.new(item[:total], Current.family.currency).format %>
    </span>
  </div>

  <div class="col-span-1 sm:col-span-3 justify-self-end">
    <span class="text-sm text-secondary">
      <%= percentage %>%
    </span>
  </div>
</div>
